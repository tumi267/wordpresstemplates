(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var l in r)e.o(r,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:r[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,r=window.wp.i18n,l=window.wp.blockEditor,n=window.wp.components,a=window.wp.element,s=window.wp.apiFetch;var o=e.n(s);const c=window.ReactJSXRuntime,i=window.React,u=JSON.parse('{"UU":"create-block/infinite-scroll"}');(0,t.registerBlockType)(u.UU,{edit:function({attributes:e,setAttributes:t}){const{postsPerPage:s,fontFamily:u,textColor:d,backgroundColor:h,backgroundOpacity:f,cutoffdate:p}=e,[g,m]=(0,a.useState)([]),[x,b]=(0,a.useState)(!1),[y,_]=(0,a.useState)(!0),j=(0,a.useRef)(1),w=(0,a.useRef)(null),[v,C]=(0,a.useState)([]),[N,S]=(0,a.useState)([]),[k,E]=(0,a.useState)([]),[I,F]=(0,a.useState)(null),[$,R]=(0,a.useState)(null),[P,B]=(0,a.useState)(null),[D,O]=(0,a.useState)(""),[T,A]=(0,a.useState)(!1);(0,a.useEffect)((()=>{j.current=1,m([]),_(!0),U(1)}),[s,I,$,P,D]);const Y=async()=>{try{const e=await o()({path:"/wp/v2/posts?per_page=1&order=asc&orderby=date&_fields=date"});if(e.length>0){const t=new Date(e[0].date).getFullYear(),r=(new Date).getFullYear();if(""!==p){let e=new Date(p).getFullYear();const r=Array.from({length:e-t+1},((e,r)=>t+r));E(r.reverse())}else{const e=Array.from({length:r-t+1},((e,r)=>t+r));E(e.reverse())}}}catch(e){console.error("Error fetching years:",e)}};(0,a.useEffect)((()=>{Y()}),[p]);const U=async e=>{if(x||null!==w.current&&e>w.current)return;b(!0);let t=`&before=${(new Date).getFullYear()}-01-01T00:00:00`;I?t+=`&after=${I}-01-01T00:00:00&before=${I}-12-31T23:59:59`:$?t+=`&categories=${$}`:P?t+=`&author=${P}`:""!=D&&(t+=`&search=${D}`);try{const r=await o()({path:`/wp/v2/posts?page=${e}&per_page=${s}&_embed${t}`,parse:!1}),l=r.headers.get("X-WP-TotalPages");l&&(w.current=parseInt(l,10));const n=await r.json();0===n.length?(w.current=null,_(!1)):(m((t=>1===e?n:[...t,...n])),_(e<w.current))}catch(e){console.error("Error fetching posts:",e)}b(!1)},W=(0,a.useRef)(null),J=(0,a.useCallback)((e=>{!x&&y&&(W.current&&W.current.disconnect(),W.current=new IntersectionObserver((e=>{e[0].isIntersecting&&y&&(j.current+=1,U(j.current))})),e&&W.current.observe(e))}),[x,y]);(0,a.useEffect)((()=>{(async()=>{try{const e=await o()({path:"/wp/v2/users?roles=author"});C(e)}catch(e){console.error("Error fetching authors:",e)}})(),(async()=>{try{const e=await o()({path:"/wp/v2/categories"});S(e)}catch(e){console.error("Error fetching categories:",e)}})(),Y()}),[]);const M=e=>{if(!e)return"Invalid date";let t=new Date(e);if(isNaN(t.getTime()))return"Invalid date";let r=t.getFullYear(),l=t.getMonth();return`${t.getDate()} ${["January","February","March","April","May","June","July","August","September","October","November","December"][l]} ${r}`},H=h?`rgba(${parseInt(h.slice(1,3),16)}, \n                ${parseInt(h.slice(3,5),16)}, \n                ${parseInt(h.slice(5,7),16)}, \n                ${f})`:"transparent",L=(0,l.useBlockProps)({style:{color:d,backgroundColor:H}});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(l.InspectorControls,{children:(0,c.jsxs)(n.PanelBody,{title:(0,r.__)("Settings","infinite-scroll"),children:[(0,c.jsx)(n.RangeControl,{label:(0,r.__)("Posts requested per scroll","infinite-scroll"),value:s,onChange:e=>t({postsPerPage:parseInt(e,10)}),min:1,max:100}),(0,c.jsx)("label",{children:(0,c.jsx)("strong",{children:"Text Color:"})}),(0,c.jsx)(n.ColorPalette,{colors:[{name:"Black",color:"#000000"},{name:"White",color:"#ffffff"},{name:"default",color:"#555555"}],value:d,onChange:e=>t({textColor:e})}),(0,c.jsx)("label",{children:(0,c.jsx)("strong",{children:"Background Color:"})}),(0,c.jsx)(n.ColorPalette,{colors:[{name:"Black",color:"#000000"},{name:"White",color:"#ffffff"}],value:h,onChange:e=>t({backgroundColor:e})}),(0,c.jsx)("label",{children:(0,c.jsx)("strong",{children:"Background Opacity:"})}),(0,c.jsx)(n.RangeControl,{value:f,onChange:e=>t({backgroundOpacity:e}),min:0,max:1,step:.1}),(0,c.jsx)(n.SelectControl,{label:(0,r.__)("Select Typography"),value:u,options:[{label:(0,r.__)("Inter"),value:"Inter, sans-serif"},{label:(0,r.__)("Roboto"),value:"Roboto, sans-serif"}],onChange:e=>{t({fontFamily:e})}}),(0,c.jsx)(n.TextControl,{label:"Cutoff Date",type:"date",value:p,onChange:e=>t({cutoffdate:e})})]})}),(0,c.jsxs)("div",{className:"display-box",children:[(0,c.jsx)("h3",{children:"BUBBLEGUMCLUB ARCHIVE 2014-2024"}),(0,c.jsxs)("p",{onClick:()=>{A(!T)},children:[1==T?"SHOW":"HIDE"," FILTERS"]})]}),T&&(0,c.jsxs)("div",{...L,style:{fontFamily:u},className:"filter-container",children:[(0,c.jsxs)("div",{className:"filter-box",children:[(0,c.jsx)("h3",{style:{color:L.style.color},className:"filter_head",children:"YEARS"}),k.length>0&&(0,c.jsx)("ul",{className:"filter_item_box",children:k.map((e=>(0,c.jsx)("li",{className:"filter_item",onClick:()=>(e=>{F(e),R(null),B(null),O(null)})(e),style:{cursor:"pointer",fontWeight:I===e?"bold":"normal"},children:e},e)))})]}),(0,c.jsxs)("div",{className:"filter-box",children:[(0,c.jsx)("h3",{style:{color:L.style.color},className:"filter_head",children:"CATEGORIES"}),N.length>0&&(0,c.jsx)("ul",{className:"filter_item_box",children:N.map((e=>(0,c.jsx)("li",{className:"filter_item",onClick:()=>{return t=e.id,R(t),F(null),B(null),void O(null);var t},style:{cursor:"pointer",fontWeight:$===e.id?"bold":"normal"},children:e.name},e.id)))})]}),(0,c.jsxs)("div",{className:"filter-box search-filter-contain",children:[(0,c.jsx)("input",{className:"search_input_infinte",placeholder:"input search",onChange:e=>{(async e=>{O(e),F(null),R(null),B(null)})(e.target.value)}}),(0,c.jsx)("button",{id:"clear-filters",onClick:()=>{F(null),R(null),B(null)},children:"Clear Filters"})]})]}),(0,c.jsx)("div",{...L,style:{fontFamily:u},id:"infinite-scroll-container",children:g.map(((e,t)=>{const r=e._embedded?.["wp:featuredmedia"]?.[0]?.source_url,l=new Date(e.date).getFullYear(),n=(new Date).getFullYear(),a=(e=>{const t=e.replace(/<[^>]+>/g,"").split(/\s+/).filter(Boolean);return t.slice(0,20).join(" ")+(t.length>20?"...":"")})(e.title.rendered);let s=e._embedded?.["wp:term"]?.[0]?.[0]?.name;return(0,i.createElement)("div",{...L,key:e.id,className:"infinite_scroll_card short_tag",ref:t===g.length-1?J:null},r?(0,c.jsx)("img",{className:"infinite_scroll_card_image",src:r,alt:e.title.rendered}):(0,c.jsx)("div",{className:"no-image",children:"Â "}),l<n&&(0,c.jsx)("div",{className:"achrive_post",children:(0,c.jsx)("h4",{children:"ARCHIVE"})}),(0,c.jsx)("h4",{className:"infinite_scroll_card_byline",children:s}),(0,c.jsx)("h3",{style:{color:L.style.color},className:"infinite_scroll_card_text",children:a}),(0,c.jsxs)("h4",{class:"infinite_scroll_card_author",children:["by ",e._embedded.author[0].name," on ",M(e.date)]}))}))}),x&&(0,c.jsx)("p",{children:"Loading more posts..."}),!y&&(0,c.jsx)("p",{children:"No more posts."})]})}})})();