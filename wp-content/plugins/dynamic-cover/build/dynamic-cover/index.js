(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,o=window.wp.i18n,r=window.wp.blockEditor,l=window.wp.components,s=window.wp.element,n=window.wp.apiFetch;var a=e.n(n);const c=window.ReactJSXRuntime,i=JSON.parse('{"UU":"create-block/dynamic-cover"}');(0,t.registerBlockType)(i.UU,{edit:function({attributes:e,setAttributes:t}){const{showByLine:n,showTitle:i,showExcurpt:p,postArticle:d,postCategory:g,fontFamily:h,textColor:u,backgroundColor:m,backgroundOpacity:x}=e,[b,y]=(0,s.useState)(d||""),[w,_]=(0,s.useState)([]),[C,j]=(0,s.useState)(g?Number(g):null),[f,v]=(0,s.useState)(null),[k,T]=(0,s.useState)(!1),S=m?`rgba(${parseInt(m.slice(1,3),16)}, \n             ${parseInt(m.slice(3,5),16)}, \n             ${parseInt(m.slice(5,7),16)}, \n             ${x})`:"transparent",I=(0,r.useBlockProps)({style:{color:u,backgroundColor:S}}),E=(0,s.useCallback)((async()=>{T(!0);try{let o;o=C?`/wp/v2/posts?categories=${encodeURIComponent(C)}&per_page=1&order=desc&_embed`:b?"/wp/v2/posts?per_page=100&order=desc&_embed":"/wp/v2/posts?per_page=1&order=desc&_embed";const r=await a()({path:o});if(r.length>0){let o;o=b?r.find((e=>e.title.rendered.toLowerCase().trim()===b.toLowerCase().trim())):r[0];const l=()=>{const e=new Date(o.date);let t=e.getDate(),r=e.getMonth(),l=e.getFullYear();return`${t} ${["January","February","March","April","May","June","July","August","September","October","November","December"][[r]]} ${l}`},s=new Date(o.date).getFullYear(),n=(new Date).getFullYear();if(o){const r={postTitle:o.title.rendered,postExcerpt:(e=o.excerpt?.rendered,e?e.replace(/^<p>|<\/p>$/g,"").split(/\s+/).slice(0,20).join(" ")+"...":""),postImage:o._embedded?.["wp:featuredmedia"]?.[0]?.source_url,postlink:o.link,postAuthor:`${o._embedded?.author?.[0].name} ${l()}`,postDate:s<n};v(r),t(b?{postArticle:b,postCategory:""}:C?{postCategory:C.toString(),postArticle:""}:{postArticle:"",postTitle:"",postExcerpt:"",postImage:"",postCategory:""})}else v(null)}else v(null)}catch(e){console.error("Error fetching posts:",e),v(null)}finally{T(!1)}var e}),[b,C,t]);return(0,s.useEffect)((()=>{const e=setTimeout(E,500);return()=>clearTimeout(e)}),[b,C,E]),(0,s.useEffect)((()=>{(async()=>{try{const e=await a()({path:"/wp/v2/categories?per_page=100"});_(e)}catch(e){console.error("Error fetching categories:",e)}})()}),[]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(r.InspectorControls,{children:(0,c.jsxs)(l.PanelBody,{title:(0,o.__)("Settings","dynamic-cover-block"),children:[(0,c.jsx)("label",{children:(0,c.jsx)("strong",{children:"Text Color:"})}),(0,c.jsx)(l.ColorPalette,{colors:[{name:"Black",color:"#000000"},{name:"White",color:"#ffffff"}],value:u,onChange:e=>t({textColor:e})}),(0,c.jsx)("label",{children:(0,c.jsx)("strong",{children:"Background Color:"})}),(0,c.jsx)(l.ColorPalette,{colors:[{name:"Black",color:"#000000"},{name:"White",color:"#ffffff"}],value:m,onChange:e=>t({backgroundColor:e})}),(0,c.jsx)("label",{children:(0,c.jsx)("strong",{children:"Background Opacity:"})}),(0,c.jsx)(l.RangeControl,{value:x,onChange:e=>t({backgroundOpacity:e}),min:0,max:1,step:.1}),(0,c.jsx)(l.TextControl,{label:(0,o.__)("Article","dynamic-cover-block"),value:b,onChange:e=>{y(e),j(null),e.trim()||t({postArticle:"",postTitle:"",postExcerpt:"",postImage:"",postCategory:""})}}),w.map((e=>(0,c.jsx)("div",{children:(0,c.jsxs)("label",{children:[(0,c.jsx)("input",{type:"radio",name:"category",checked:C===e.id,onChange:()=>{C===e.id?(j(null),t({postCategory:"",postTitle:"",postExcerpt:"",postImage:""})):(j(e.id),y(""))}}),e.name]})},e.id))),(0,c.jsx)(l.ToggleControl,{checked:!!i,label:(0,o.__)("Show Title","dynamic-cover-block"),onChange:()=>t({...e,showTitle:!i})}),(0,c.jsx)(l.ToggleControl,{checked:!!p,label:(0,o.__)("Show Excerpt","dynamic-cover-block"),onChange:()=>t({...e,showExcurpt:!p})}),(0,c.jsx)(l.ToggleControl,{checked:!!n,label:(0,o.__)("Show by line","dynamic-cover-block"),onChange:()=>t({...e,showByLine:!n})}),(0,c.jsx)(l.SelectControl,{label:(0,o.__)("Select Typography"),value:h,options:[{label:(0,o.__)("Inter"),value:"Inter, sans-serif"},{label:(0,o.__)("Roboto"),value:"Roboto, sans-serif"}],onChange:e=>{t({fontFamily:e})}})]})}),(0,c.jsx)("div",{...(0,r.useBlockProps)(),style:{fontFamily:h},children:k?(0,c.jsx)("p",{children:"Loading..."}):f?(0,c.jsxs)("div",{...I,className:"cover_contain",children:[(0,c.jsxs)("a",{href:`${f.postlink}`,children:[f.postDate&&(0,c.jsx)("div",{className:"cover_achrive_post",children:(0,c.jsx)("h3",{children:"ARCHIVE"})}),(0,c.jsxs)("div",{style:{color:I.style.color},className:"cover_text",children:[i&&(0,c.jsx)("h1",{children:f.postTitle}),p&&(0,c.jsx)("h3",{className:"cover_text excurpt_cover",dangerouslySetInnerHTML:{__html:f.postExcerpt}}),n&&(0,c.jsxs)("h4",{children:["by ",f.postAuthor," "]})]})]}),f.postImage&&(0,c.jsx)("img",{className:"post_img",src:f.postImage,alt:f.postTitle})]}):(0,c.jsx)("p",{children:"No matching post found"})})]})}})})();